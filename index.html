<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<title>Roots of Renewal</title>
<style>
body { font-family: sans-serif; background: #f0f8ff; text-align: center; margin: 0; padding: 0; }
header { background: #228B22; color: white; padding: 10px; }
.resources { display: flex; justify-content: center; flex-wrap: wrap; gap: 8px; margin: 10px 0; }
.pill { background: #fff; color: #228B22; padding: 4px 8px; border-radius: 20px; font-weight: bold; font-size: 0.9em; min-width: 80px; text-align: center; }
button { margin: 6px 0; padding: 12px; font-size: 1em; border-radius: 8px; border: none; cursor: pointer; width: 90%; max-width: 400px; }
#scatterBtn { background: #32cd32; color: white; }
#prestigeBtn { background: #8b0000; color: white; }
.shop { margin-top: 15px; }
.shop h3 { margin: 12px 0 6px 0; font-size: 1.1em; }
.shop button { display: block; margin: 4px auto; }
.shop div { font-size: 0.9em; margin: 2px 0; }
#prestigeReport { background: #fff; padding: 12px; border: 2px solid #228B22; border-radius: 10px; margin: 12px auto; width: 90%; max-width: 450px; display: none; font-size: 0.95em; }
#journal { background: #fff8dc; border: 2px solid #deb887; border-radius: 10px; width: 95%; max-width: 500px; margin: 15px auto; padding: 8px; text-align: left; height: 250px; overflow-y: auto; font-size: 0.9em; }
#journal h3 { margin-top: 0; font-size: 1em; }
.entry { margin: 3px 0; }
</style>
</head>
<body>
<header>
  <h1>🌱 Roots of Renewal</h1>
  <div class="resources">
    <div class="pill">🌱 Seeds: <span id="seeds">0</span></div>
    <div class="pill">🌿 Plants: <span id="plants">0</span></div>
    <div class="pill">🐝 Pollinators: <span id="pollinators">0</span></div>
    <div class="pill">🤲 Stewardship: <span id="stewardship">0</span></div>
    <div class="pill">🌎 Env: <span id="env">1.0</span>x</div>
    <div class="pill">🧬 Diversity: <span id="div">1.0</span>x</div>
    <div class="pill">📚 Eco Knowledge: <span id="eco">0</span>x</div>
    <div class="pill">🏞️ Restored: <span id="restored">0</span> sq ft</div>
  </div>
</header>

<main>
  <button id="scatterBtn">Scatter Seeds 🌱 +1</button>
  <div id="plantCounts"></div>
  <div id="pollinatorCounts"></div>
  <div class="shop" id="shopBody"></div>
  <button id="prestigeBtn">Rewild Land (Prestige)</button>
  <div id="prestigeReport"></div>
  <div id="journal">
    <h3>📓 Field Notes</h3>
    <div id="entries"></div>
  </div>
</main>

<script>
// --- State ---
let state={seeds:0,plants:{},pollinators:{},envQuality:1.0,stewardship:0,ecoKnowledge:0,restored:0};
let firstAutoPlantLogged=false,lastLoggedSeeds=0;

// --- Plants & Pollinators ---
const PLANTS=[{name:"Purple Coneflower",cost:10,rate:1},{name:"Butterfly Milkweed",cost:30,rate:3},{name:"Little Bluestem",cost:60,rate:5},{name:"Prairie Blazing Star",cost:120,rate:10}];
const POLLINATORS=[
  {name:"Monarch Butterfly",boost:0.2,envReq:1.5,host:"Butterfly Milkweed",food:"Prairie Blazing Star"},
  {name:"Rusty Patched Bumblebee",boost:0.4,envReq:2.0,host:"Purple Coneflower",food:"Prairie Blazing Star"},
  {name:"Hummingbird Clearwing Moth",boost:0.6,envReq:2.5,host:"Little Bluestem",food:"Butterfly Milkweed"}
];
const LANDMARKS=[{size:100,label:"a backyard garden"},{size:1000,label:"a community park"},{size:10000,label:"a small prairie"},{size:100000,label:"a nature reserve"},{size:1000000,label:"a national park"}];

// --- Colors ---
const PLANT_COLORS={"Purple Coneflower":"#9b59b6","Butterfly Milkweed":"#e67e22","Little Bluestem":"#3498db","Prairie Blazing Star":"#e74c3c"};
const POLLINATOR_COLORS={"Monarch Butterfly":"#f39c12","Rusty Patched Bumblebee":"#d35400","Hummingbird Clearwing Moth":"#2ecc71"};
const JOURNAL_COLORS={...PLANT_COLORS,...POLLINATOR_COLORS};

// --- Journal ---
function logEntry(text,species){
  const entries=document.getElementById("entries");
  const div=document.createElement("div");
  div.className="entry";
  div.textContent=text;
  if(species && JOURNAL_COLORS[species]){div.style.color=JOURNAL_COLORS[species]; div.style.fontWeight="bold";}
  entries.appendChild(div);
  entries.scrollTop=entries.scrollHeight;
}

// --- Scatter Seeds ---
function scatter(){
  state.seeds+=1;
  const magnitude=Math.floor(Math.log10(state.seeds));
  const nextThreshold=Math.pow(10,magnitude);
  if(state.seeds===1||(state.seeds===nextThreshold && state.seeds!==lastLoggedSeeds)){
    lastLoggedSeeds=state.seeds;
    let msg="";
    if(state.seeds===1) msg="🌱 Scattered the first seed; a tiny sprout may soon emerge.";
    else if(state.seeds===10) msg="🌱 Ten seeds now lie in the soil; tiny shoots may soon peek through.";
    else if(state.seeds===100) msg="🌱 A hundred seeds scattered; the meadow begins to stir with life.";
    else if(state.seeds===1000) msg="🌱 A thousand seeds cover the ground; a flourishing patch emerges.";
    else if(state.seeds===10000) msg="🌱 Tens of thousands of seeds lie sown; the land hums with renewed vitality.";
    else msg=`🌱 ${state.seeds.toLocaleString()} seeds scattered; nature awakens slowly.`;
    logEntry(msg);
  }
  render();
}

// --- Buy Plant ---
function buyPlant(plant){
  if(state.seeds>=plant.cost){state.seeds-=plant.cost;state.plants[plant.name]=(state.plants[plant.name]||0)+1;
  logEntry(`🌿 Planted ${plant.name}; its leaves and blooms will invite pollinators soon.`,plant.name);
  render();}
}

// --- Improve Environment ---
function improveEnvironment(){
  if(state.stewardship>=20){state.stewardship-=20;state.envQuality+=0.2;
  logEntry(`🌎 The land feels healthier; the soil and surrounding flora thrive a little more.`);
  render();}
}

// --- Check Pollinators ---
function checkPollinators(){
  POLLINATORS.forEach(pol=>{
    if(!state.pollinators[pol.name]){
      let envOk=state.envQuality>=pol.envReq;
      let hostOk=(state.plants[pol.host]||0)>0;
      let foodOk=(state.plants[pol.food]||0)>0;
      if(envOk && hostOk && foodOk){state.pollinators[pol.name]=true; logEntry(`🐝 ${pol.name} arrives, drawn by the ${pol.host} and ${pol.food}; its presence signals a flourishing habitat.`,pol.name);}
    }
  });
}

// --- Weighted Random Plant ---
function choosePlantByWeight(plants){
  let totalWeight=plants.reduce((sum,p)=>sum+(1/p.cost),0);
  let rand=Math.random()*totalWeight;
  for(let plant of plants){rand-=(1/plant.cost); if(rand<=0) return plant;}
  return plants[plants.length-1];
}

// --- Prestige / Rewild ---
function prestige(){
  let addedRestored=Math.floor(state.stewardship*2+Object.values(state.plants).reduce((a,b)=>a+b,0)*5);
  state.restored+=addedRestored;
  state.ecoKnowledge+=1;
  let comparison=LANDMARKS.reduce((acc,mark)=>{if(state.restored>=mark.size) acc=mark.label; return acc;}, "a patch of wildflowers");
  document.getElementById("prestigeReport").innerHTML=`<h3>🌎 Rewilding Complete!</h3>
    <p>You restored <b>${addedRestored.toLocaleString()}</b> sq ft this run.</p>
    <p>Total restored: <b>${state.restored.toLocaleString()}</b> sq ft — about the size of ${comparison}.</p>
    <p>Your work inspires others, earning <b>+1 Eco Knowledge</b>.</p>`;
  document.getElementById("prestigeReport").style.display="block";
  logEntry(`📖 Rewilding complete! This run restored ${addedRestored.toLocaleString()} sq ft. Total restored: ${state.restored.toLocaleString()} sq ft — roughly the size of ${comparison}. Nature celebrates your stewardship.`);
  state.seeds=0; state.plants={}; state.pollinators={}; state.envQuality=1.0; state.stewardship=0;
  firstAutoPlantLogged=false; lastLoggedSeeds=0;
  document.getElementById("entries").innerHTML="";
  render();
}

// --- Plant Counts ---
function renderPlantCounts(){
  const div=document.getElementById("plantCounts");
  div.innerHTML="<h3>🌿 Plant Counts</h3>";
  PLANTS.forEach(plant=>{
    const count=state.plants[plant.name]||0;
    const d=document.createElement("div");
    d.textContent=`${plant.name}: ${count}`;
    d.style.color=PLANT_COLORS[plant.name]||"#000"; d.style.fontWeight="bold";
    div.appendChild(d);
  });
}

// --- Pollinator Counts ---
function renderPollinatorCounts(){
  const div=document.getElementById("pollinatorCounts");
  div.innerHTML="<h3>🐝 Pollinator Counts</h3>";
  POLLINATORS.forEach(pol=>{
    const present=state.pollinators[pol.name]?"1+":"0";
    const d=document.createElement("div");
    d.textContent=`${pol.name}: ${present}`;
    d.style.color=POLLINATOR_COLORS[pol.name]||"#000"; d.style.fontWeight="bold";
    div.appendChild(d);
  });
}

// --- Shop ---
function renderShop(){
  const shopBody=document.getElementById("shopBody"); shopBody.innerHTML="";
  const h=document.createElement("h3"); h.textContent="Plant Shop"; shopBody.appendChild(h);
  PLANTS.forEach(plant=>{
    const btn=document.createElement("button");
    btn.textContent=`Buy ${plant.name} (${plant.cost} seeds) [+${plant.rate}/tick]`;
    btn.addEventListener("click",()=>buyPlant(plant));
    shopBody.appendChild(btn);
  });
  const h2=document.createElement("h3"); h2.textContent="Habitat Restoration"; shopBody.appendChild(h2);
  const envBtn=document.createElement("button"); envBtn.textContent="Improve Environment (+0.2) [20 Stewardship]";
  envBtn.addEventListener("click",improveEnvironment); shopBody.appendChild(envBtn);
  const h3=document.createElement("h3"); h3
